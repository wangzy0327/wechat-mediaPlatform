<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Bootstrap用户登录页面实现</title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <link href="" rel="stylesheet">
    <!-- 这里要替换成你自己的BootStrap引入方式 -->
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
<header class="page-header text-center">
    <h1>后台登录页面</h1>
</header>
<div class="container">
    <!--<form role="form" action = "manage/user/login" method="post">-->
    <form role="form" id="form">
        <div class="form-horizontal">
            <div class="form-group">
                <label class="col-sm-2 control-label">用户名</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="username" name = "username" placeholder="请输入用户名">
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-2 control-label">密码</label>
                <div class="col-sm-10">
                    <input type="password" class="form-control" id="password" name = "password" placeholder="请输入密码">
                </div>
            </div>
            <strong>
                <div class="span12 centered-text"><p style="text-align: center" id="message"></p></div>
            </strong>
            <!--<div class="form-group">-->
            <!--<label class="control-label col-sm-2">-->
            <!--性别-->
            <!--</label>-->
            <!--<div class="col-sm-10">-->
            <!--<input type="radio" name="sex"> 男-->
            <!--<input type="radio" name="sex"> 女-->
            <!--</div>-->
            <!--</div>-->

            <div class="form-group">
                <div class="col-sm-2">

                </div>
                <div class="col-sm-8">
                    <!--<button class="btn btn-success">注册</button>-->
                    <input type="button" id = "login_btn" class="btn btn-primary" value = "提交"/>
                    <!--<button id = "forget_password_btn" class="btn btn-info">忘记密码</button>-->
                </div>
                <div class="col-sm-2">
                    <a class="btn btn-info" href="#" target="_blank">忘记密码</a>
                </div>
            </div>
        </div>
    </form>
</div>
</body>
<script type="text/javascript">
    $(document).ready(function () {
        $("#login_btn").click(login);
    })
    function login() {
        if(!$("#username").val()) {
            $("#username").focus();
            return;
        }
        if(!$("#password").val()) {
            $("#password").focus();
            return;
        }
        var str = $("#form").serialize();
//        var data = {"username":username, "password":password};
        $.post({
            url: "/wechat-tools/manage/user/login",
            data: $("#form").serialize(),
            success: function (result) {
                var msg =${message};
                console.log("message:"+message);//打印'随便写点东西'
                console.log(result);
                if (result.status == 0) {
                    window.sessionStorage.setItem("CURRENT_USER",result.data.id);
                    console.log(window.sessionStorage.getItem("CURRENT_USER"));
                    window.location.href = "/page/backend/wxItem/backend.html";
                } else {
                    document.getElementById("message").style.color = "red";
                    document.getElementById("message").innerHTML = result.msg;
                    window.cookie
                    window.sessionStorage.clear();
                    return;
                }
            },
            error: function (result) {
                document.getElementById("message").style.color = "red";
                document.getElementById("message").innerHTML = "请求失败，网络异常";
                console.log(result);
            }
        })
//        $.ajax({
//            type: "POST",
//            url: "manage/user/login",
//            async: false,
//            data: JSON.stringify(data),
//            contentType: "application/json",
//            success: function(response){
//                console.log(response);
//                if(response.status == 0){
//                    window.location.href="backend.html";
//                }else{
//                    document.getElementById("message").style.color ="red";
//                    document.getElementById("message").innerHTML = response.msg;
//                    return;
//                }
//            },
//            error:function(response){
//                document.getElementById("message").style.color = "red";
//                document.getElementById("message").innerHTML = "请求失败，网络异常";
//                console.log(response);
//            }
//    });
    }
</script>
</html>